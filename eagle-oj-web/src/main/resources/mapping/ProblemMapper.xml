<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="problem">
    <insert id="insertProblem" parameterType="ProblemEntity" useGeneratedKeys="true" keyProperty="pid">
        INSERT INTO `problem` (owner, title, code_language, description,
                               input_format, output_format, difficult, samples, moderators,
                               tags, status, create_time) VALUES (#{owner}, #{title}, #{codeLanguage}, #{description},
        #{inputFormat}, #{outputFormat}, #{difficult}, #{samples}, #{moderators}, #{tags}, #{status}, #{createTime})
    </insert>

    <select id="getProblemByPid" resultMap="problemResultMap">
        SELECT * from `problem` WHERE `pid` = #{pid}
    </select>

    <select id="getAllProblem" resultMap="problemResultMap">
        SELECT * FROM `problem`
    </select>

    <update id="addProblemSubmitTimes">
        UPDATE `problem` SET `submit_times` = `submit_times` + 1 WHERE `pid` = #{pid}
    </update>

    <update id="addProblemAcceptTimes">
        UPDATE `problem` SET `accept_times` = `accept_times` + 1 WHERE `pid` = #{pid}
    </update>

    <update id="updateProblemDescription" parameterType="ProblemEntity">
        UPDATE `problem` SET `title`=#{title}, `description`=#{description}, `input_format`=#{inputFormat},
            `output_format`=#{outputFormat}, `samples`=#{samples}, `difficult`=#{difficult}, `tags`=#{tags}
        WHERE `pid`=#{pid}
    </update>

    <resultMap id="problemResultMap" type="ProblemEntity">
        <id column="pid" property="pid"/>
        <result column="owner" property="owner"/>
        <result column="title" property="title"/>
        <result column="code_language" property="codeLanguage"/>
        <result column="description" property="description"/>
        <result column="input_format" property="inputFormat"/>
        <result column="output_format" property="outputFormat"/>
        <result column="samples" property="samples"/>
        <result column="moderators" property="moderators"/>
        <result column="tags" property="tags"/>
        <result column="submit_times" property="submitTimes"/>
        <result column="used_times" property="usedTimes"/>
        <result column="ac_times" property="ACTimes"/>
        <result column="wa_times" property="WATimes"/>
        <result column="rte_times" property="RTETimes"/>
        <result column="tle_times" property="TLETimes"/>
        <result column="ce_times" property="CETimes"/>
        <result column="status" property="status"/>
        <result column="create_time" property="createTime"/>
    </resultMap>
</mapper>
